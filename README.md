# Quantifying the emissions impact of corporate netzero targets

This repo contains all power sector related analysis in support of the [NetZero cluster](https://salatainstitute.harvard.edu/projects/evaluating-net-zero-pledges/) within the [Salata Institute for Climate and Sustainability](https://salatainstitute.harvard.edu/) at Harvard University. 

## Table of Contents
This readme file is structured as follows
1. [Introduction](#introduction)
3. [Navigating the folders in this repository](#Navigating-the-folders-in-this-repository)
2. [Generating the analysis dataset](#generating-the-analysis-dataset)
4. [Data sources](#data-sources)

## Introduction
In 2021, the US emitted over 6,000 million metric tons of CO2 equivalent (MMTCO2e) (EPA, 2021). Electric power production accounts for roughly one quarter of these emissions, emitting more than all other sectors except transportation (EIA FAQ) (EIA, 2022). Nearly all emissions from electricity generation (98%) come from coal and natural gas combustion (EIA, 2023).

CO2 emissions in the electricity sector have declined about 35 percent in the last 15 years (US CBO). This trend has largely been driven by a shift in electricity generation mix away from coal toward natural gas, due to significant drops in natural gas prices (EIA, 2022). To less of a degree, increased renewable energy installation and stringent environmental regulations can also be attributed for this decline in emissions ([[INSERT: source]]).

The analysis in this repo focuses on electricity generation from both independent power producers and utilities. Energy Information Administration (EIA) and the Environmental Protection Agency (EPA) maintain detailed operations and emissions data for the sector. EIA, a federal agency under the U.S. Department of Energy, provides energy-related data, including production and consumption. EPA, the federal agency responsible for environmental protection, collects emissions and regulatory compliance data.

Through our data analysis, we assess how market forces (e.g., input prices and new technologies), subsidies, regulations, and internal benefits (e.g., marketing, hiring, financing) affect corporate emissions reductions in the electricity sector. Are companies within this sector exceeding reductions expected from subsidies and regulation alone? If so, why? With such insights, the net zero team can also assess whether regulatory design options could further support this behavior.

We start with an analysis of ownership and divestment, and of the CO2 emission intensity of electricity generation. We examine how utility and plant ownership changes over time, and seek to understand the nature of plants that are divested and shutdown. We also examine investment decisions and operational improvements connected to emission intensity. 

With these insights, we will extend this analysis to understand correlations of these outcomes with market forces, policies, and net-zero claims. This latter analysis is outside the scope of this repo.

## Navigating the folders and files in this repository
This repo is structured as follows

| Folder/File | Description |
|-------------|-------------|
| [`analysis`](./analysis) | One-off analysis conducted over the course of the project | 
| [`code`](./code) | Source code for generating the analysis dataset | 
| [`├── align`](./code/align) | Scripts to align and merge all transformed datasets into a final analysis dataset | 
| [`├── extract`](./code/extract) | Scripts to download all datasets | 
| [`├── transform`](./code/transform) | Scripts to transform downloaded datasets | 
| [`└── utils.py`](./code/utils.py) | Utility functions for the project | 
| [`data`](./data) | Data used and generated by the project | 
| [`├── final`](./data/final) | Final merged datasets ready for analysis |
| [`├── interim`](./data/interim) | Intermediate data processing | 
| [`├── processed`](./data/processed) | Processed data ready for analysis | 
| [`├── raw`](./data/raw) | Raw data | 
| [`└── resources`](./data/resources) | Additional resources | 
| [`documentation`](./documentation) | Documentation for data pipeline | 
| [`results` ](./results)| Results from analyses | 
| [`.gitignore`](./.gitignore) | Specifies intentionally untracked files to ignore in repo | 
| **[THIS FILE][`README.md`](./README.md)** | **[THIS FILE] Detailed description of the project** | 
| [`requirements.txt`](./requirements.txt) | List of dependencies for the project | 
| [`snakefile` ](./snakefile) | Main Snakemake workflow file to generate analysis datasets | 


## Generating the analysis dataset
The codebase in this repo was written exclusively with Python. It uses the [Snakemake workflow management system](https://snakemake.readthedocs.io/en/stable/) to systematically run all python code to generate reproduceable analysis datasets. To generate the analysis and datasets locally, please follow the steps below. These steps assume the user has [Python](https://www.python.org/downloads/) and [Git](https://git-scm.com/) installed and running on their local machine. 

### Clone repository
To clone the repository, open a terminal, navigate to the desired parent folder, and run the following command:

```
git clone https://github.com/etrieschman/netzero.git
cd netzero
```

### Create a virtual environment
Creating a virtual environment is recommended to manage the dependencies. From the local repo folder, use the following command to do so

```
python -m venv venv.netzero
```

To activate the virtual environment, use the appropriate command for your operating system:
* On macOS and Linux
```
source venv.netzero/bin/activate
```
* On Windows
```
venv.netzero/Scripts/activate
```

### Load requirements
With the virtual environment activated, install the required packages using:
```
pip install -r requirements.txt
```

### Request credentials to access EPA data
This code queries EPA data through its API. To accomplish this, the user must register with the EPA for a free API key through the following steps

1. Request an API key through the [EPA Clean Air Markets API Portal](https://www.epa.gov/power-sector/cam-api-portal)
2. Create a new python file in [`code/extract`](./code/extract/) called `credentials.py`
3. Save your EPA API key to this file in the following format
```
EPA_API_KEY = 'YOUR API KEY HERE, MAKE SURE IT'S IN QUOTATIONS'
```

### Run Snakemake pipeline
Finally, to run the Snakemake pipeline and generate the analysis datasets locally, execute:
```
snakemake -j4
```

When working with Snakemake, it is recommended to always perform a dry run of the pipeline first, which can be accomplished with
```
snakemake -j4 -n
```

The generated analysis datasets can be found in the `data/final` directory after the Snakemake pipeline has finished running. Refer to the [data/README.md](./data/README.md) in the results directory for detailed descriptions of the raw datasets and resources.